/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
author: mercurio22 (https://sketchfab.com/mercurio22)
license: CC-BY-NC-4.0 (http://creativecommons.org/licenses/by-nc/4.0/)
source: https://sketchfab.com/3d-models/nike-air-max-90-premium-4b2280c16b67481cba0fe7ffacd77011
title: Nike Air Max 90 Premium
*/

import React, { useRef } from "react";
import { useGLTF } from "@react-three/drei";
import { useFrame } from "@react-three/fiber";
import {  useScroll} from "@react-three/drei";
import * as THREE from "three";
import { sections } from "../../../data/sections";

export const Shoe = ({ scale, rotation, position }) => {
  const { nodes, materials } = useGLTF("/assets/scene.gltf");
  const scroll = useScroll();
  const ref = useRef();
  const d = 0.01;

  useFrame(() => {
    const x = sections[Math.floor(scroll.range(0, 1) * sections.length)]
    const modelRotation = x.modelRotation
    const modelPosition = x.modelPosition

    if(ref.current.rotation!=modelRotation ){

    ref.current.rotation.set(
      THREE.MathUtils.damp(ref.current.rotation.x, modelRotation[0], 4, d),
      THREE.MathUtils.damp(ref.current.rotation.y, modelRotation[1], 4, d),
      THREE.MathUtils.damp(ref.current.rotation.z, modelRotation[2], 4, d)
    );}
    if(ref.current.position!=modelPosition ){
    ref.current.position.set(
    THREE.MathUtils.damp(ref.current.position.x, modelPosition[0], 4, d),
    THREE.MathUtils.damp(ref.current.position.y, modelPosition[1], 4, d),
    THREE.MathUtils.damp(ref.current.position.z, modelPosition[2], 4, d))
  }
  });

  return (
    <group
      scale={scale}
      rotation={rotation}
      position={position}
      ref={ref}
      dispose={null}
    >
      <mesh
        castShadow
        geometry={nodes.Base1_Base2_0.geometry}
        material={materials.Base2}
      />
      <mesh
        castShadow
        geometry={nodes.Base1_Logo_0.geometry}
        material={materials.Logo}
      />
      <mesh
        castShadow
        geometry={nodes.Base1_lambert1_0.geometry}
        material={materials.lambert1}
      />
      <mesh
        castShadow
        geometry={nodes.Base1_Cordones_0.geometry}
        material={materials.Cordones}
      />
      <mesh
        castShadow
        geometry={nodes.Base1_Suela_0.geometry}
        material={materials.Suela}
      />
    </group>
  );
}

useGLTF.preload("/assets/scene.gltf");
